<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>CoinIMP Live Stats</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    background:#000;
    color:#0f0;
    font-family: "Courier New", monospace;
    text-align:center;
}

/* compteur numérique style montre / année */
.counter {
    font-size:48px;
    letter-spacing:4px;
    background:#020;
    display:inline-block;
    padding:15px 25px;
    border:2px solid #0f0;
    margin:20px auto;
}

canvas {
    max-width:90%;
    margin:auto;
}
</style>
</head>

<body>

<h2>CoinIMP – Hashes en temps réel</h2>

<div id="digitalCounter" class="counter">000000000</div>

<canvas id="chart"></canvas>

<script>
const SITE_KEY = "c909ccf8810603fd4771d73c7ea34f460ef48b2eb49dfefbc072127a27495c39";
const API_URL = `https://www.coinimp.com/api/v2/site/${SITE_KEY}`;

let labels = [];
let values = [];

const ctx = document.getElementById("chart").getContext("2d");

const chart = new Chart(ctx, {
    type: "line",
    data: {
        labels: labels,
        datasets: [{
            label: "Total Hashes",
            data: values,
            borderWidth: 2,
            tension: 0.25
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});

function formatCounter(num) {
    return num.toString().padStart(9, "0");
}

async function update() {
    try {
        const res = await fetch(API_URL);
        const json = await res.json();

        // CoinIMP retourne total_hashes
        const hashes = Math.floor(json.total_hashes || 0);

        document.getElementById("digitalCounter").textContent =
            formatCounter(hashes);

        const time = new Date().toLocaleTimeString();
        labels.push(time);
        values.push(hashes);

        if (labels.length > 25) {
            labels.shift();
            values.shift();
        }

        chart.update();
    } catch (e) {
        console.error("Erreur CoinIMP", e);
    }
}

update();
setInterval(update, 5000);
</script>

</body>
</html>

